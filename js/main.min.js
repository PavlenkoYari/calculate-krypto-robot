window.addEventListener("DOMContentLoaded",e=>{const t={prices:{},miningPerHour:(e=0,a)=>{const o={json:!0,code:"kryptonstake",table:"accounts",scope:"kryptonstake",limit:"10000"};return a&&(o.lower_bound=a),fetch("https://wax.eosphere.io/v1/chain/get_table_rows",{method:"POST",body:JSON.stringify(o)}).then(e=>e.json()).then(a=>{const o=a.rows.reduce((e,t)=>e+=Number(t.mining_power),e);return a.more?t.miningPerHour(o,a.next_key):(document.getElementById("mining_per_hour").innerHTML=`<span style="text-decoration: none">Mining power:</span>${Number(13541/o).toFixed(4)} Cube/hr`,13541/o)})},getCubePrice:e=>fetch("https://wax.alcor.exchange/api/markets/296").then(e=>e.json()).then(t=>{return document.getElementById("cube_price").innerHTML=`<span>Cube Price:</span>${Number(t.last_price).toFixed(4)} WAX / ${Number(t.last_price*e).toFixed(4)} USD`,t.last_price}),getKryptonPrice:e=>fetch("https://wax.alcor.exchange/api/markets/297").then(e=>e.json()).then(t=>{return document.getElementById("krypton_price").innerHTML=`<span>Krypton Price:</span>${Number(t.last_price).toFixed(4)} WAX / ${Number(t.last_price*e).toFixed(4)} USD`,t.last_price}),getPrices:()=>fetch("https://api.coingecko.com/api/v3/simple/price?ids=wax&vs_currencies=usd").then(e=>e.json()).then(e=>{const a=e.wax.usd;return document.getElementById("wax_price").innerHTML=`<span>WAX Price:</span>${Number(a).toFixed(4)} USD`,Promise.all([t.miningPerHour(),t.getCubePrice(a),t.getKryptonPrice(a)]).then(e=>{document.querySelector(".loader").remove();const[o,s,n]=e;return t.prices={waxPrice:a,cubePrice:s,kryptonPrice:n,miningPerHour:o},t.getFactionRanks(),{waxPrice:a,cubePrice:s,kryptonPrice:n,miningPerHour:o}})}),getFactionRanks:(e={titan:[],asteria:[],chaos:[]},a)=>{const o={json:!0,code:"kryptonmissn",table:"atksmission",scope:"kryptonmissn",limit:"10000"};a&&(o.lower_bound=a),fetch("https://wax.eosphere.io/v1/chain/get_table_rows",{method:"POST",body:JSON.stringify(o)}).then(e=>e.json()).then(a=>{const o=a.rows.reduce((e,t)=>("Titan"===t.race&&(e.titan=[...e.titan,t]),"Astraea"===t.race&&(e.asteria=[...e.asteria,t]),"Chaos"===t.race&&(e.chaos=[...e.chaos,t]),e),e);if(a.more)return t.getFactionRanks(o,a.next_key);const s={titan:{color:"rgb(253, 18, 73)",name:"Titan"},chaos:{color:"rgb(206, 0, 255)",name:"Chaos"},asteria:{color:"rgb(58, 175, 252)",name:"Asteria"}};Object.keys(o).forEach(e=>{const t=document.getElementById(e);t.insertAdjacentHTML("beforeend",`<div class="sticky faction__table_title" style="color: ${s[e].color}">${s[e].name}</div>`),t.insertAdjacentHTML("beforeend",'<div class="sticky faction__table_row"><div class="faction__table_cell">Rank</div><div class="faction__table_cell">User</div><div class="faction__table_cell">Mission score</div></div>')}),Object.keys(o).map(e=>{const t=document.getElementById(e);o[e].sort((e,t)=>t.atk_power-e.atk_power).forEach((e,a)=>{t.insertAdjacentHTML("beforeend",`<div class="faction__table_row"><div class="faction__table_cell">${a+1}</div><div class="faction__table_cell">${e.user}</div><div class="faction__table_cell">${e.atk_power}</div></div>`)})})})},getStamina:()=>{fetch("https://wax.eosphere.io/v1/chain/get_table_rows",{method:"POST",body:JSON.stringify({json:!0,code:"kryptonasset",table:"assetsinfos",scope:"kryptonasset",limit:"1",lower_bound:document.querySelector(".calculator__form.stamina .form .form__group_field[name='asset_id']").value})}).then(e=>e.json()).then(e=>{const t=document.getElementById("staminaInfo"),[a]=e.rows;if(!a){document.querySelector(".calculator__form.stamina .form .form__group_field[name='asset_id']").value="";let e="";return e+='<p class="calculator__result_item">Stamina info: <span>0/0</span></p>',e+='<p class="calculator__result_item">HP info: <span>0/0</span></p>',t.innerHTML=e,alert("Nothing not found")}document.querySelector(".calculator__form.stamina .form .form__group_field[name='asset_id']").value=a.asset_id;let o="";o+=`<p class="calculator__result_item">Stamina info: <span>${a.stamina_remain}/${a.stamina}</span></p>`,o+=`<p class="calculator__result_item">HP info: <span>${a.hp_remain}/${a.hp}</span></p>`,t.innerHTML=o}).catch(e=>{console.error(e),alert("Nothing not found")})},getStaminaHandler:()=>{$(".calculator__form.stamina .form__submit").click(()=>{t.getStamina()})},getUserInfo:()=>{fetch("https://wax.eosphere.io/v1/chain/get_table_rows",{method:"POST",body:JSON.stringify({json:!0,code:"kryptonmissn",table:"atksmission",scope:"kryptonmissn",limit:"1",lower_bound:document.querySelector(".calculator__form.userStatistic .form .form__group_field[name='playermission']").value,upper_bound:document.querySelector(".calculator__form.userStatistic .form .form__group_field[name='playermission']").value})}).then(e=>e.json()).then(e=>{const[t]=e.rows;if(!t){const e=document.getElementById("user_info");document.querySelector(".calculator__form.userStatistic .form .form__group_field[name='playermission']").value="";let t="";return t+='<p class="calculator__result_item">Wallet address: <span>N/A</span></p>',t+='<p class="calculator__result_item">User race: <span>N/A</span></p>',t+='<p class="calculator__result_item">Mining power, Cube: <span>0</span></p>',t+='<p class="calculator__result_item">Attack power: <span>0</span></p>',t+='<p class="calculator__result_item">Mission score: <span>0</span></p>',e.innerHTML=t,alert("Nothing not found")}fetch("https://wax.eosphere.io/v1/chain/get_table_rows",{method:"POST",body:JSON.stringify({json:!0,code:"kryptonstake",table:"accounts",scope:"kryptonstake",limit:"1",lower_bound:document.querySelector(".calculator__form.userStatistic .form .form__group_field[name='playermission']").value,upper_bound:document.querySelector(".calculator__form.userStatistic .form .form__group_field[name='playermission']").value})}).then(e=>e.json()).then(e=>{const[a]=e.rows;if(!a){const e=document.getElementById("user_info");document.querySelector(".calculator__form.userStatistic .form .form__group_field[name='playermission']").value="";let t="";return t+='<p class="calculator__result_item">Wallet address: <span>N/A</span></p>',t+='<p class="calculator__result_item">User race: <span>N/A</span></p>',t+='<p class="calculator__result_item">Mining power, Cube: <span>0</span></p>',t+='<p class="calculator__result_item">Attack power: <span>0</span></p>',t+='<p class="calculator__result_item">Mission score: <span>0</span></p>',e.innerHTML=t,alert("Nothing not found")}const o=document.getElementById("user_info");let s="";s+=`<p class="calculator__result_item">Wallet address: <span>${t.user}</span></p>`,s+=`<p class="calculator__result_item">User race: <span>${t.race}</span></p>`,s+=`<p class="calculator__result_item">Mining power, Cube: <span>${Number(a.mining_power).toFixed(4)}</span></p>`,s+=`<p class="calculator__result_item">Attack power: <span>${Number(a.attack_power).toFixed(4)}</span></p>`,s+=`<p class="calculator__result_item">Mission score: <span>${t.atk_power}</span></p>`,o.innerHTML=s}).catch(e=>{console.error(e),alert("Nothing not found")})})},getUserInfoHandler:()=>{$(".calculator__form.userStatistic .form__submit").click(()=>{t.getUserInfo()})},calculate:(e=720)=>{const{waxPrice:a,cubePrice:o,kryptonPrice:s,miningPerHour:n}=t.prices,l=document.querySelector(".calculator__form.calculator .form .form__group_field[name='common']").value||0,r=document.querySelector(".calculator__form.calculator .form .form__group_field[name='silver']").value||0,c=document.querySelector(".calculator__form.calculator .form .form__group_field[name='gold']").value||0,p=document.querySelector(".calculator__form.calculator .form .form__group_field[name='commona']").value||0,i=document.querySelector(".calculator__form.calculator .form .form__group_field[name='silvera']").value||0,u=document.querySelector(".calculator__form.calculator .form .form__group_field[name='golda']").value||0;if(!(l||r||c||p||i||u)){const e=document.getElementById("expense_all");let t="";t+='<p class="calculator__result_item"><span style="font-weight: bold;">Cube</span> cost: <span>0</span></p>',t+='<p class="calculator__result_item"><span style="font-weight: bold;">Krypton</span> cost: <span>0</span></p>',t+='<p class="calculator__result_item"><span style="font-weight: bold;">WAX</span> cost: <span>0</span></p>',t+='<p class="calculator__result_item"><span style="font-weight: bold;">USD</span> cost: <span>0</span></p>',e.innerHTML=t;const a=document.getElementById("expense_miner");let o="";o+='<p class="calculator__result_item"><span style="font-weight: bold;">Cube</span> cost: <span>0</span></p>',o+='<p class="calculator__result_item"><span style="font-weight: bold;">Krypton</span> cost: <span>0</span></p>',o+='<p class="calculator__result_item"><span style="font-weight: bold;">WAX</span> cost: <span>0</span></p>',o+='<p class="calculator__result_item"><span style="font-weight: bold;">USD</span> cost: <span>0</span></p>',a.innerHTML=o;const s=document.getElementById("expense_attaker");let n="";n+='<p class="calculator__result_item"><span style="font-weight: bold;">Cube</span> cost: <span>0</span></p>',n+='<p class="calculator__result_item"><span style="font-weight: bold;">Krypton</span> cost: <span>0</span></p>',n+='<p class="calculator__result_item"><span style="font-weight: bold;">WAX</span> cost: <span>0</span></p>',n+='<p class="calculator__result_item"><span style="font-weight: bold;">USD</span> cost: <span>0</span></p>',s.innerHTML=n;const l=document.getElementById("income_net");let r="";r+='<p class="calculator__result_item"><span style="font-weight: bold;">Netto Cube</span> income: <span>0</span></p>',r+='<p class="calculator__result_item"><span style="font-weight: bold;">Netto WAX</span> income: <span>0</span></p>',r+='<p class="calculator__result_item"><span style="font-weight: bold;">Netto USD</span> income: <span>0</span></p>',l.innerHTML=r;const c=document.getElementById("income_brutto");let p="";return p+='<p class="calculator__result_item"><span style="font-weight: bold;">Brutto Cube</span> income: <span>0</span></p>',p+='<p class="calculator__result_item"><span style="font-weight: bold;">Brutto WAX</span> income: <span>0</span></p>',p+='<p class="calculator__result_item"><span style="font-weight: bold;">Brutto USD</span> income: <span>0</span></p>',void(c.innerHTML=p)}const _={income:{cube:{common:1,silver:1.3,gold:3}},expense:{cube:{common:.18,silver:3/(125/6),gold:.1},krypton:{common:.015/(100/6),silver:.0072,gold:.005}}},m={info:{hp:{common:100,silver:120,gold:300},stamina:{common:.1875,silver:.1429,gold:.1}},expense:{cube:{common:.06,silver:.05,gold:3/85},krypton:{common:.003,silver:.0025,gold:.15/85}}},d=l*_.expense.cube.common+r*_.expense.cube.silver+c*_.expense.cube.gold,f=p*m.expense.cube.common+i*m.expense.cube.silver+u*m.expense.cube.gold,b=l*_.expense.krypton.common+r*_.expense.krypton.silver+c*_.expense.krypton.gold,g=p*m.expense.krypton.common+i*m.expense.krypton.silver+u*m.expense.krypton.gold,y=document.getElementById("expense_all");let h="";h+=`<p class="calculator__result_item"><span style="font-weight: bold;">Cube</span> cost: <span>${Number((d+f)*e).toFixed(4)}</span></p>`,h+=`<p class="calculator__result_item"><span style="font-weight: bold;">Krypton</span> cost: <span>${Number((b+g)*e).toFixed(4)}</span></p>`,h+=`<p class="calculator__result_item"><span style="font-weight: bold;">WAX</span> cost: <span>${Number(((b+g)*s+(d+f)*o)*e).toFixed(4)}</span></p>`,h+=`<p class="calculator__result_item"><span style="font-weight: bold;">USD</span> cost: <span>${Number(((b+g)*s+(d+f)*o)*a*e).toFixed(4)}</span></p>`,y.innerHTML=h;const w=document.getElementById("expense_miner");let x="";x+=`<p class="calculator__result_item"><span style="font-weight: bold;">Cube</span> cost: <span>${Number(d*e).toFixed(4)} </span></p>`,x+=`<p class="calculator__result_item"><span style="font-weight: bold;">Krypton</span> cost: <span>${Number(b*e).toFixed(4)} </span></p>`,x+=`<p class="calculator__result_item"><span style="font-weight: bold;">WAX</span> cost: <span>${Number(d*o*e+b*s*e).toFixed(4)}</span></p>`,x+=`<p class="calculator__result_item"><span style="font-weight: bold;">USD</span> cost: <span>${Number((d*o*e+b*s*e)*a).toFixed(4)}</span></p>`,w.innerHTML=x;const v=document.getElementById("expense_attaker");let k="";k+=`<p class="calculator__result_item"><span style="font-weight: bold;">Cube</span> cost: <span>${Number(f*e).toFixed(4)}</span></p>`,k+=`<p class="calculator__result_item"><span style="font-weight: bold;">Krypton</span> cost: <span>${Number(g*e).toFixed(4)}</span></p>`,k+=`<p class="calculator__result_item"><span style="font-weight: bold;">WAX</span> cost: <span>${Number(f*o*e+g*s*e).toFixed(4)}</span></p>`,k+=`<p class="calculator__result_item"><span style="font-weight: bold;">USD</span> cost: <span>${Number((f*o*e+g*s*e)*a).toFixed(4)}</span></p>`,v.innerHTML=k;const S=l*_.income.cube.common*n+r*_.income.cube.silver*n+c*_.income.cube.gold*n,N=S*o,$=N*a,T=S-d-f-s*(b+g)/o,H=T*o,M=H*a,P=document.getElementById("income_net");let B="";B+=`<p class="calculator__result_item"><span style="font-weight: bold;">Netto Cube</span> income: <span>${Number(T*e).toFixed(4)}</span></p>`,B+=`<p class="calculator__result_item"><span style="font-weight: bold;">Netto WAX</span> income: <span>${Number(H*e).toFixed(4)}</span></p>`,B+=`<p class="calculator__result_item"><span style="font-weight: bold;">Netto USD</span> income: <span>${Number(M*e).toFixed(4)}</span></p>`,P.innerHTML=B;const F=document.getElementById("income_brutto");let E="";E+=`<p class="calculator__result_item"><span style="font-weight: bold;">Brutto Cube</span> income: <span>${Number(S*e).toFixed(4)}</span></p>`,E+=`<p class="calculator__result_item"><span style="font-weight: bold;">Brutto WAX</span> income: <span>${Number(N*e).toFixed(4)}</span></p>`,E+=`<p class="calculator__result_item"><span style="font-weight: bold;">Brutto USD</span> income: <span>${Number($*e).toFixed(4)}</span></p>`,F.innerHTML=E},calculateHandler:()=>{$(".calculator__form.calculator .form__group_field").keyup(()=>{t.calculate()}),$(".calculator__result.calculator .calculator__result_action_btn").click(e=>{const a=$(e.currentTarget);"hour"===a.data("dateRange")&&t.calculate(1),"day"===a.data("dateRange")&&t.calculate(24),"month"===a.data("dateRange")&&t.calculate(720),$(".calculator__result.calculator .calculator__result_action_btn").removeClass("active"),a.addClass("active")})},converter:()=>{const{waxPrice:e,cubePrice:a,kryptonPrice:o}=t.prices,s=Number(document.querySelector(".calculator__form.converter .form .form__group_field[name='cube_count']").value)||0,n=Number(document.querySelector(".calculator__form.converter .form .form__group_field[name='krypton_count']").value)||0,l=Number(document.querySelector(".calculator__form.converter .form .form__group_field[name='wax_count']").value)||0;if(s){const t=document.getElementById("cube_count");let o="";o+=`<p class="calculator__result_item">${s} CUBE to WAX: <span>${Number(a*s).toFixed(4)}</span></p>`,o+=`<p class="calculator__result_item">${s} CUBE to USD: <span>${Number(a*e*s).toFixed(4)}</span></p>`,t.innerHTML=o}else{const e=document.getElementById("cube_count");let t="";t+='<p class="calculator__result_item">CUBE to WAX: <span>0</span></p>',t+='<p class="calculator__result_item">CUBE to USD: <span>0</span></p>',e.innerHTML=t}if(n){const t=document.getElementById("krypton_count");let a="";a+=`<p class="calculator__result_item">${n} KRYPTON to WAX: <span>${Number(o*n).toFixed(4)}</span></p>`,a+=`<p class="calculator__result_item">${n} KRYPTON to USD: <span>${Number(o*e*n).toFixed(4)}</span></p>`,t.innerHTML=a}else{const e=document.getElementById("krypton_count");let t="";t+='<p class="calculator__result_item">KRYPTON to WAX: <span>0</span></p>',t+='<p class="calculator__result_item">KRYPTON to USD: <span>0</span></p>',e.innerHTML=t}if(l){const t=document.getElementById("wax_count");let a="";a+=`<p class="calculator__result_item">${l} WAX to USD: <span>${Number(l*e).toFixed(4)}</span></p>`,t.innerHTML=a}else{const e=document.getElementById("wax_count");let t="";t+='<p class="calculator__result_item">WAX to USD: <span>0</span></p>',e.innerHTML=t}},converterHandler:()=>{$(".calculator__form.converter .form__group_field").keyup(()=>{t.converter()})},loaderText:()=>{const e=["Keep calm and mining cube","Добро к добру","Smile more often, it will save the world","The robots are coming. Watch your back","Be calm and just enjoy","If not today, then when?","It's just the word 'CAT'","The universe sees everything","Look forward. The gears are spinning","Robots are one piece. Be whole, be robot!","Robot like a exchange rate, you never know when to collapse"],a=e[Math.floor(Math.random()*(e.length+1))];if(!a)return t.loaderText();document.querySelector(".loader .loader__text").innerHTML=a}};t.loaderText(),t.getPrices(),t.calculateHandler(),t.getUserInfoHandler(),t.getStaminaHandler(),t.converterHandler()});